CREATE TABLE STUDENT(
    USN INT,S_NAME VARCHAR(10),
    ADDRESS VARCHAR(20),
    PHONE INT,
    GENDER VARCHAR(10),
    PRIMARY KEY(USN)
    );

CREATE TABLE SEM_SEC(
    SSID INT,
    SEM INT,
    SEC VARCHAR(5),
    PRIMARY KEY(SSID)
    );

CREATE TABLE CLASS(
    USN INT,
    SSID INT,
    FOREIGN KEY(USN) REFERENCES STUDENT(USN),
    FOREIGN KEY(SSID) REFERENCES SEM_SEC(SSID)
    );

CREATE TABLE SUBJECTS(
    SUBCODE INT,
    TITLE VARCHAR(20),
    SEM INT,
    CREDITS INT,
    PRIMARY KEY(SUBCODE)
    );

CREATE TABLE MARKS(
    USN INT,
    SUBCODE INT,
    SSID INT,
    TEST1 INT,
    TEST2 INT,
    TEST3 INT,
    FOREIGN KEY(USN) REFERENCES STUDENT(USN),
    FOREIGN KEY(SSID) REFERENCES SEM_SEC(SSID),
    FOREIGN KEY(SUBCODE) REFERENCES SUBJECTS(SUBCODE)
    );

INSERT INTO STUDENT VALUES(44,'DEVANG','RR NAGAR',231213,'MALE');
INSERT INTO STUDENT VALUES(22,'AYMAN','INDIRANAGAR',231232,'MALE');
INSERT INTO STUDENT VALUES(11,'SAM','INDIRANAGAR',231432,'FEMALE');
INSERT INTO STUDENT VALUES(55,'SHAAN','MG ROAD',212543,'MALE');
INSERT INTO STUDENT VALUES(33,'TANYA','WHITE FIELD',231443,'FEMALE');
SELECT * FROM STUDENT;

INSERT INTO SEM_SEC VALUES(2,6,'B');
INSERT INTO SEM_SEC VALUES(4,4,'C');
INSERT INTO SEM_SEC VALUES(5,4,'B');
INSERT INTO SEM_SEC VALUES(3,4,'A');
INSERT INTO SEM_SEC VALUES(1,2,'B');
SELECT * FROM SEM_SEC;

INSERT INTO CLASS VALUES(33,5);
INSERT INTO CLASS VALUES(11,4);
INSERT INTO CLASS VALUES(55,2);
INSERT INTO CLASS VALUES(22,4);
INSERT INTO CLASS VALUES(44,4);
SELECT * FROM CLASS;

INSERT INTO SUBJECTS VALUES(20,'DBMS',2,4);
INSERT INTO SUBJECTS VALUES(10,'MP',4,4);
INSERT INTO SUBJECTS VALUES(40,'ADA',1,4);
INSERT INTO SUBJECTS VALUES(30,'LD',5,3);
INSERT INTO SUBJECTS VALUES(50,'COA',3,3);
SELECT * FROM SUBJECTS;

INSERT INTO MARKS VALUES(33,10,5,19,19,20);
INSERT INTO MARKS VALUES(22,50,4,16,15,12);
INSERT INTO MARKS VALUES(55,30,2,19,19,19);
INSERT INTO MARKS VALUES(22,40,4,12,18,16);
INSERT INTO MARKS VALUES(44,10,4,10,12,11);
INSERT INTO MARKS VALUES(11,20,4,15,14,13);
SELECT * FROM MARKS;

SELECT * FROM STUDENT S WHERE S.USN IN (SELECT C.USN FROM CLASS C,SEM_SEC S WHERE S.SSID=C.SSID AND S.SEM=4 AND S.SEC='C');

SELECT S.GENDER,SS.SEM,SS.SEC,COUNT(*) FROM STUDENT S,SEM_SEC SS,CLASS C WHERE C.USN=S.USN AND C.SSID=SS.SSID GROUP BY SS.SSID;

CREATE VIEW USN_22(USN,SUB,MARKS) AS SELECT M.USN,S.TITLE,M.TEST1 FROM MARKS M,SUBJECTS S WHERE M.SUBCODE=S.SUBCODE AND M.USN=22;
SELECT * FROM USN_22;

ALTER TABLE MARKS ADD COLUMN FINAL_ALL FLOAT;
UPDATE MARKS SET FINAL_ALL=((TEST1+TEST2+TEST3)-LEAST(TEST1,TEST2,TEST3))/2;
SELECT * FROM MARKS;

ALTER TABLE MARKS ADD COLUMN CATEGORY VARCHAR(20);
UPDATE MARKS SET CATEGORY= 
				CASE
					WHEN FINAL_ALL>=17 AND FINAL_ALL<=20 THEN 'OUTSTANDING'
                    WHEN FINAL_ALL>=12 AND FINAL_ALL<17 THEN 'AVERAGE'
                    WHEN FINAL_ALL<12 THEN 'WEAK'
				END;
SELECT * FROM MARKS;
